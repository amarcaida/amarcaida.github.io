<!DOCTYPE html>
<html lang="en">
    <head>
        <title>GAME START</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" href="gamestart.css">
        <script>
            var bHP=rHP=mHP=10;
            var m1HP=m2HP=10;
            var bsHP=20;
            var MP=0;
            var win=lose=false;

            function checkWinLoss(){
                if(bsHP==0 && m1HP==0 && m2HP==0){
                    win=true;
                    document.getElementById('text').innerHTML="YOU WON.";
                }
                else if(mHP==0 && bHP==0 && rHP==0){
                    lose=true;
                    document.getElementById('text').innerHTML="YOU LOST.";
                }
                else{
                    win, lose = false;
                }
                if(win==true || lose==true){
                    console.log('start timer');
                    backtomenu();
                }
            }
            async function backtomenu(){
                await new Promise(resolve => setTimeout(resolve, 3000));
                console.log('after 1 second');
                document.location.href="index.html";
            }
            function displayBella(){
                var elements=document.querySelectorAll(".hide");
                var elemCount = elements.length;
                for (var i=0; i<elemCount; i++){
                    elements[i].className="btn btn-outline-warning";
                }
                document.getElementById('hiddenButton1').innerHTML="HEAL";
                document.getElementById('hiddenButton2').innerHTML="HP BURST";
            }
            function displayRok(){
                var elements=document.querySelectorAll(".hide");
                var elemCount = elements.length;
                for (var i=0; i<elemCount; i++){
                    elements[i].className="btn btn-outline-warning";
                }
                document.getElementById('hiddenButton1').innerHTML="MERCY";
                document.getElementById('hiddenButton2').innerHTML="BLOCK";
            }
            function displayMno(){
                var elements=document.querySelectorAll(".hide");
                var elemCount = elements.length;
                for (var i=0; i<elemCount; i++){
                    elements[i].className="btn btn-outline-warning";
                }
                document.getElementById('hiddenButton1').innerHTML="ATTACK";
                document.getElementById('hiddenButton2').innerHTML="MASS MURDER";
            }
            function setHP(){
                if(mHP>10){
                    mHP=10;
                    document.getElementById('msnoHP').innerHTML="MISS NO: " + mHP +" HP";
                }
                else if(mHP<=0){
                    mHP=0;
                    document.getElementById('msnoHP').innerHTML="MISS NO: " + mHP +" HP";
                    document.getElementById('msnoSprite').src="images/msno/msno-dead.png";
                }
                else{
                    mHP=mHP;
                    document.getElementById('msnoHP').innerHTML="MISS NO: " + mHP +" HP";
                    document.getElementById('msnoSprite').src="images/msno/msno.png";
                }
                if(bHP>10){
                    bHP=10;
                    document.getElementById('bellaHP').innerHTML="BELLA: " + bHP +" HP";
                }
                else if (bHP<=0){
                    bHP=0;
                    document.getElementById('bellaHP').innerHTML="BELLA: " + bHP +" HP";
                    document.getElementById('bellaSprite').src="images/bella/bella-dead.png";
                }
                else{
                    bHP=bHP;
                    document.getElementById('bellaHP').innerHTML="BELLA: " + bHP +" HP";
                    document.getElementById('bellaSprite').src="images/bella/bella.png";
                }
                if(rHP>10){
                    rHP=10;
                    document.getElementById('rokHP').innerHTML="ROK: " + rHP +" HP";
                }
                else if(rHP<=0){
                    rHP=0;
                    document.getElementById('rokHP').innerHTML="ROK: " + rHP +" HP";
                    document.getElementById('rokSprite').src="images/rok/rok-dead.png";
                }
                else{
                    rHP=rHP;
                    document.getElementById('rokHP').innerHTML="ROK: " + rHP +" HP";
                    document.getElementById('rokSprite').src="images/rok/rok.png";
                }
                if(m1HP<=0){
                    m1HP=0;
                    document.getElementById('minion1HP').innerHTML="MINION 1: " + m1HP +" HP";
                    document.getElementById('min1Sprite').src="images/minions/minion1-dead.png";
                }
                else{
                    m1HP=m1HP;
                    document.getElementById('minion1HP').innerHTML="MINION 1: " + m1HP +" HP";
                    document.getElementById('min1Sprite').src="images/minions/minion.png";
                }
                if(m2HP<=0){
                    m2HP=0;
                    document.getElementById('minion2HP').innerHTML="MINION 2: " + m2HP +" HP";
                    document.getElementById('min2Sprite').src="images/minions/minion2-dead.png";
                }
                else{
                    m2HP=m2HP;
                    document.getElementById('minion2HP').innerHTML="MINION 2: " + m2HP +" HP";
                    document.getElementById('min2Sprite').src="images/minions/minion.png";
                }
                if(bsHP<=0){
                    bsHP=0;
                    document.getElementById('bossHP').innerHTML="BOSS: " + bsHP + " HP";
                    document.getElementById('bossSprite').src="images/boss/boss-dead.png";
                }
                else{
                    bsHP=bsHP;
                    document.getElementById('bossHP').innerHTML="BOSS: " + bsHP + " HP";
                    document.getElementById('bossSprite').src="images/boss/boss.png";
                }
                if(MP<0){
                    MP=0;
                    document.getElementById('mana').innerHTML="MANA: " + MP;
                }
                else{
                    MP=MP;
                    document.getElementById('mana').innerHTML="MANA: " + MP;
                }
            }
            function enemyTurn(){
                var num=rng();
                switch(num){
                    case 1:
                        document.getElementById('text').innerHTML+=" The enemy has attacked. Bella lost 2 HP.";
                        bHP-=2;
                        break;
                    case 2:
                        document.getElementById('text').innerHTML+=" The enemy has attacked. Rok lost 2 HP.";
                        rHP-=2;
                        break;
                    case 3:
                        document.getElementById('text').innerHTML+=" The enemy has attacked. Miss No lost 2 HP.";
                        mHP-=2;
                        break;                   
                    default:
                        document.getElementById('text').innerHTML+=" The enemy has attacked. All party members has lost 2 HP.";
                        bHP-=2;
                        rHP-=2;
                        mHP-=2;
                        break;
                    }
                console.log("attack done");
                rehide();
                setHP();
                checkWinLoss();
            }
            function showCharacter(){
                var playerSelector=document.querySelectorAll(".hideplayers");
                var playerCount=playerSelector.length;
                for(var i=0; i<playerCount; i++){
                    playerSelector[i].className="players";
                }
            }
            function showEnemy(){
                var enemyShow=document.querySelectorAll(".hideenemies");
                var enemyCount=enemyShow.length;
                for(var i=0; i<enemyCount;i++){
                    enemyShow[i].className="enemies"
                }
            }
            function rehide(){
                var hidePlayer=document.querySelectorAll(".players");
                var hidePlayerCount=hidePlayer.length;
                for (var i=0; i<hidePlayerCount; i++){
                    hidePlayer[i].className="players hideplayers";
                }
                var hideEnemies=document.querySelectorAll(".enemies");
                var hideEnemiesCount=hideEnemies.length;
                for (var i=0; i<hideEnemiesCount; i++){
                    hideEnemies[i].className="enemies hideenemies";
                }
            }
            function rng(){
                var num = Math.floor(Math.random() * 4);
                return num;
            }
            function srng(){
                var num = Math.floor(Math.random() * 3);
                return num;
            }
            function selectCharacter(chr){
                var num;
                switch(chr){
                    case 1:
                        if(bHP==10){
                            document.getElementById('text').innerHTML="Bella Already has 10HP";
                            rehide();
                        }
                        else{
                            num = rng();
                            switch(num){
                                case 1:
                                    document.getElementById('text').innerHTML="Healing Failed. Bella did not gain any HP.";
                                    MP+=2;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 2:
                                    document.getElementById('text').innerHTML="Healing Success. Bella gained 3HP.";
                                    bHP+=3;
                                    MP+=2;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 3:
                                    document.getElementById('text').innerHTML="Healing Success! Bella gained 7HP.";
                                    bHP+=7;
                                    MP+=2;
                                    enemyTurn();
                                    rehide();
                                    break;
                            }
                        }
                        break;
                    case 2:
                        if(rHP==10){
                            document.getElementById('text').innerHTML="Rok Already has 10HP";
                            rehide();
                        }
                        else{
                            num = rng();
                            switch(num){
                                case 1:
                                    document.getElementById('text').innerHTML="Healing Failed. Rok did not gain any HP.";
                                    MP+=2;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 2:
                                    document.getElementById('text').innerHTML="Healing Success. Rok gained 3HP.";
                                    MP+=2;
                                    rHP+=3;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 3:
                                    document.getElementById('text').innerHTML="Healing Success! Rok gained 7HP.";
                                    MP+=2;
                                    rHP+=7;
                                    enemyTurn();
                                    rehide();
                                    break;
                            }
                        }
                        break;
                    case 3:
                        if(mHP==10){
                            document.getElementById('text').innerHTML="Miss No Already has 10HP";
                            rehide();
                        }
                        else{
                            num = rng();
                            switch(num){
                                case 1:
                                    document.getElementById('text').innerHTML="Healing Failed. Miss No did not gain any HP.";
                                    MP+=2;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 2:
                                    document.getElementById('text').innerHTML="Healing Success. Miss No gained 3HP.";
                                    MP+=2;
                                    mHP+=3;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 3:
                                    document.getElementById('text').innerHTML="Healing Success! Miss No gained 7HP.";
                                    MP+=2;
                                    mHP+=7;
                                    enemyTurn();
                                    rehide();
                                    break;
                            }
                        }
                        break;
                    case 4:
                        if(m1HP==0){
                            document.getElementById('text').innerHTML="You've Already Defeated Minion 1.";
                            rehide();
                        }
                        else{
                            num = rng();
                            switch(num){
                                case 1:
                                    document.getElementById('text').innerHTML="Attack Failed. Minion 1 did not lose any HP.";
                                    MP+=2;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 2:
                                    document.getElementById('text').innerHTML="Attack Success. Minion 1 lost 3HP.";
                                    m1HP-=3;
                                    MP+=2;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 3:
                                    document.getElementById('text').innerHTML="Attack Success! Minion 1 lost 7HP.";
                                    m1HP-=7;
                                    MP+=2;
                                    enemyTurn();
                                    rehide();
                                    break;
                            }
                        }
                        break;
                    case 5:
                        if(m2HP==0){
                            document.getElementById('text').innerHTML="You've Already Defeated Minion 2.";
                            rehide();
                        }
                        else{
                            num = rng();
                            switch(num){
                                case 1:
                                    document.getElementById('text').innerHTML="Attack Failed. Minion 2 did not lose any HP.";
                                    MP+=2;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 2:
                                    document.getElementById('text').innerHTML="Attack Success. Minion 2 lost 3HP.";
                                    MP+=2;
                                    m2HP-=3;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 3:
                                    document.getElementById('text').innerHTML="Attack Success! Minion 2 lost 7HP.";
                                    MP+=2;
                                    m2HP-=7;
                                    enemyTurn();
                                    rehide();
                                    break;
                            }
                        }
                        break;
                    case 6:
                        if(bsHP==0){
                            document.getElementById('text').innerHTML="You've Already Defeated the Main Boss.";
                            rehide();
                        }
                        else{
                            num = rng();
                            switch(num){
                                case 1:
                                    document.getElementById('text').innerHTML="Attack Failed. Main Boss did not lose any HP.";
                                    MP+=2;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 2:
                                    document.getElementById('text').innerHTML="Attack Success. Main Boss lost 3HP.";
                                    MP+=2;
                                    bsHP-=3;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 3:
                                    document.getElementById('text').innerHTML="Attack Success! Main Boss lost 7HP.";
                                    MP+=2;
                                    bsHP-=7;
                                    enemyTurn();
                                    rehide();
                                    break;
                            }
                        }
                        break;
                }
            }
            function choice(event){
                var x=event.target.innerHTML;
                switch(x){
                    case "HEAL":
                        if(bHP>0){
                            document.getElementById('text').innerHTML="Select a character to HEAL.";
                            showCharacter();
                        }
                        else{
                            document.getElementById('text').innerHTML="Bella has lost all her HP. Try someone else.";
                            rehide();
                        }
                        break;
                    case "HP BURST":
                        if(bHP>0){
                            var num = srng();
                            if(MP>2){
                                switch(num){
                                    case 1:
                                        document.getElementById('text').innerHTML="Everyone gained 5HP."
                                        bHP+=5;
                                        rHP+=5;
                                        mHP+=5;
                                        MP-=3;
                                        enemyTurn();
                                        rehide();
                                        break;
                                    case 2:
                                        document.getElementById('text').innerHTML="Everyone was fully healed."
                                        bHP=rHP=mHP=10;
                                        MP-=3;
                                        enemyTurn();
                                        rehide();
                                        break;
                                }
                            }
                            else
                                document.getElementById('text').innerHTML="Not enough mana. Need at least 3."
                                rehide();
                            }
                        else{
                            document.getElementById('text').innerHTML="Bella has lost all her HP. Try someone else.";
                            rehide();
                        }                        
                        break;
                    case "MERCY":
                        if(rHP>0){
                            document.getElementById('text').innerHTML="No mercy. We die like men.";
                            enemyTurn();
                            rehide();
                        }
                        else{
                            document.getElementById('text').innerHTML="Rok has lost all their HP. Try someone else.";
                            rehide();
                        }
                        break;
                    case "BLOCK":
                        if(rHP>0){
                            var num = srng();
                        if(MP>1){
                            switch(num){
                            case 1:
                                document.getElementById('text').innerHTML="The enemies attacked. Everyone lost 1HP. Boss lost 1 HP";
                                bHP-=1;
                                rHP-=1;
                                mHP-=1;
                                bsHP-=1;
                                MP-=1;
                                rehide();
                                setHP();
                                break;
                            case 2:
                                document.getElementById('text').innerHTML="The enemies attacked. No HP was lost. Boss lost 3 HP";
                                bsHP-=3;
                                bHP=bHP;
                                rHP=rHP;
                                mHP=mHP;
                                MP-=1;
                                rehide();
                                setHP();
                                break;
                            }
                        }
                        else
                            document.getElementById('text').innerHTML="Not enough mana. Need at least 2."
                            rehide();
                        }
                        else{
                            document.getElementById('text').innerHTML="Rok has lost all their HP. Try someone else.";
                        }                    
                        break;
                    case "ATTACK":
                        if(mHP>0){
                            document.getElementById('text').innerHTML="Select an enemy to ATTACK.";
                            showEnemy();
                        }
                        else{
                            document.getElementById('text').innerHTML="Ms. No has lost all her HP. Try someone else.";
                        }
                        break;
                    case "MASS MURDER":
                        if(mHP>0){
                            var num = srng();
                            if(MP>4){
                                switch(num){
                                case 1:
                                    document.getElementById('text').innerHTML="All enemies lost 5HP."
                                    m1HP-=5;
                                    m2HP-=5;
                                    bsHP-=5;
                                    MP-=5;
                                    enemyTurn();
                                    rehide();
                                    break;
                                case 2:
                                    document.getElementById('text').innerHTML="All enemies lost 7HP."
                                    m1HP-=7;
                                    m2HP-=7;
                                    bsHP-=7;
                                    MP-=5;
                                    enemyTurn();
                                    rehide();
                                    break;
                                }
                            }
                            else
                                document.getElementById('text').innerHTML="Not enough mana. Need at least 5."
                                rehide();
                        }
                        else{
                            document.getElementById('text').innerHTML="Ms. No has lost all her HP. Try someone else.";
                        }
                        break;
                }
            }
        </script>
    </head>
    <body>
        <div class="container">
            <div class="row1">
                <h1>BOSS BATTLE</h1>
                <div id="game">
                    <div id="chrSprites">
                        <div class="brSprite">
                            <img id="bellaSprite" alt="Bella" src="images/bella/bella.png">
                        </div>
                        <div class="brSprite">
                            <img id="rokSprite" alt="Rok" src="images/rok/rok.png">
                        </div>
                        <div class="mSprite">
                            <img id="msnoSprite" alt="Ms No" src="images/msno/msno.png">
                        </div>
                    </div>
                    <div class="column">
                        <h4 id="msnoHP">MISS NO: 10 HP</h4>
                        <h4 id="bellaHP">BELLA: 10 HP</h4>
                        <h4 id="rokHP">ROK: 10 HP</h4>
                        <p id="mana">MANA: 0</p>
                        <div class="players hideplayers" onclick="selectCharacter(1);"></div>
                        <div class="players hideplayers" onclick="selectCharacter(2);"></div>
                        <div class="players hideplayers" onclick="selectCharacter(3);"></div>
                    </div>
                    <div id="enSprites">
                        <div id="minSprites">
                            <div class="minSprite">     
                                <img id="min1Sprite" alt="minion 1" src="images/minions/minion.png">                  
                            </div>
                            <div class="minSprite">  
                                <img id="min2Sprite" alt="minion 2" src="images/minions/minion.png">                            
                            </div>
                        </div>
                        <div id="bsSprite">
                            <img id="bossSprite" alt="boss" src="images/boss/boss.png">
                        </div>
                    </div>
                    <div class="column" style="right: 0;">
                        <h4 id="bossHP">BOSS: 20 HP</h4>
                        <h4 id="minion1HP">MINION 1: 10 HP</h4>
                        <h4 id="minion2HP">MINION 2: 10 HP</h4>
                        <div class="enemies hideenemies">
                            <div class="minions">
                                <div class="minion" onclick="selectCharacter(4);"></div>
                                <div class="minion" onclick="selectCharacter(5);"></div>
                            </div>
                            <div class="boss" onclick="selectCharacter(6);"></div>
                        </div>
                    </div>
                </div>
                <div id="textbox">
                    <div class="container-fluid">
                        <p id="text">WAITING FOR MOVE...</p>
                    </div>
                </div>
            </div>
            <div class="row2">
                <div class="container-fluid">
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <p>CHOOSE YOUR MOVE.</p>
                            </div>
                            <div class="row text-center">
                                <div class="col">
                                    <button class="btn btn-outline-warning hide" id="hiddenButton1" onclick="choice(event);">.</button>
                                </div>
                                <div class="col">
                                    <button class="btn btn-outline-warning hide" id="hiddenButton2" onclick="choice(event);">.</button>
                                </div>
                            </div>
                            
                        </div>
                        <div class="card-footer">
                            <div class="row">
                            <div class="col">
                                <button class="btn btn-block btn-primary" onclick="displayBella();">BELLA</button>
                            </div>
                            <div class="col">
                                <button class="btn btn-block btn-success" onclick="displayRok();">ROK</button>
                            </div>
                            <div class="col">
                                <button class="btn btn-block btn-danger" onclick="displayMno();">MISS NO</button>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
